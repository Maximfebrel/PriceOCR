# PriceOCR

Данный проект посвящен детекции чисел на картинках. Целевыми метриками являются accuracy и CER. Рассматриваемая задача является задачей детекции объектов.

Цель проекта: создать инструмент для распознавания цен на картинках.

Задачи проекта:

1. Проанализировать датасет, узнать возможные символы на картинках;
2. Спроектировать архитектуру нейронной сети для решения задачи или воспользоваться предобученной моделью OCR;
3. Проанализировать полученные результаты;
4. Оформить решение проекта (разбить проект на модули, написать комментарии к коду и сформировать отчет по проделанной работе).

## Запуск кода

На первом этапе необходимо убедиться в наличии подключения к сети интернет, в коде используется предобученная модель EasyOCR, которая устанавливается при запуске проекта. Далее осуществляется установка необходимых зависимостей при помощи запуска в терминале команды *pip install -r requirements.txt*.

Далее разорхивировать исходные данные для решения задачи: они должны располагаться внутри директории проекта в папке data/.

Далее необходимо выбрать модель, при помощи которой предполагается получить оцифровку. Было выполнено решение с использованием 4 различных моделей, которые хранятся в переменной MODEL_TYPES. Необходимо выбрать одну из них задав значение переменной MODEL_TYPE одним из ключей словаря MODEL_TYPES.

Далее необходимо запустить код из файла main.py. Это можно сделать при помощи команды *py main.py* из терминала.

## Описание файлов

Всего в работе присутствует несколько файлов:

1. *CNN.py*. Данный файл содержит в себе написанный архитектуры нейронных сетей;
2. *EasyOCR.py*. Данный файл содержит в себе предобученную модель EasyOCR для решения задачи [1];
3. *Loader.py*. Данный файл содержит в себе загрузчик исходных данных;
4. *main.py*. Данный файл содержит в себе функцию для запуска кода;
5. *Model.py*. Данный файл содержит в себе класс для обучения и тестирования созданных архитектур CNN и CRNN;
6. *ModelBox.py*. Данный файл содержит в себе класс для обучения и тестирования созданной архитектуры CNNBox;
7. Файл *data.zip* содержит в себе исходные данные, файл *result.zip* содержит в себе результаты работы проекта (графики функций потерь и размеченные тестовые датасеты);
8. Файл *.gitignore* содержит в себе файлы, которые игнорируются Git, файл *requirements.txt* содержит в себе информацию о необходимых зависимостях в проекте.

## Предобработка данных

Данные были предобработаны следующим образом: 

1. Ресайз;
2. Нормализация.

## Теоретическое описание архитектур нейронных сетей

Оптимизатором для всех описанных ниже архитектур нейронных сетей, которые были созданы вручную используется оптимизатор Adam.

### 1. CNN

***Описание***

Данная архитектура предполагает собой использование сверточной нейронной сети сразу к исходному изображению.

***Обоснование***

Поскольку задача является распознаванием изображений - первое, что приходит на ум применить сверточную нейронную сеть к исходным данным. В модели используется функция потерь Connectionist Temporal Classification (CTC), поскольку все числа могут быть разного размера. 

***Гиперпараметры***

В работе данная нейронная сеть была обучена на 20 эпохах с использованием скорости обучения равной 0.01.

### 2. CRNN

***Описание***

Данная архитектура предполагает собой использование сверточной и рекуррентной нейронных сетей  к исходному изображению.

***Обоснование***

Поскольку в задаче распознается цена (которая является определенной последовательностью цифр) было принято решение добавить к написанной архитектуре CNN рекуррентный слой  для учета последовательности цифр. В модели используется функция потерь Connectionist Temporal Classification (CTC), поскольку все числа могут быть разного размера. 

***Гиперпараметры***

В работе данная нейронная сеть была обучена на 20 эпохах с использованием скорости обучения равной 0.01.

Для декодировки последовательности в обеих описанных выше архитектурах использовалась функция decode_greedy, описанная в классе Model в файле *Model.py*, которая использует greedy-декодирование. Помимо этого была добавлена функция decode_beam, которая использует beam-декодирование. 

### 3. CNNBox

***Описание***

Данная архитектура предполагает собой использование сверточной нейронной сети к предварительно разбитому на отдельные цифры исходному изображению.

***Обоснование***

в датасете цифры четко разделены между собой, поэтому возможно первоначальная детекция цифр на исходном изображении и дальнейшее применение к данным цифрам архитектуры CNN, описанной в п. 1. Поскольку задача превращается в задачу классификации 10 цифр, для решения задачи была использована функция потерь Cross Entrophy. 

***Гиперпараметры***

В работе данная нейронная сеть была обучена на 10 эпохах с использованием скорости обучения равной 0.01.


### 4. EasyOCR

Для решения задачи использовалось готовая предобученная модель.

## Оценка точности

### 1. CNN

Падение функции потерь при использовании данной архитектуры приведено на графике

![loss_CNN](https://github.com/user-attachments/assets/e7589b01-a9b6-4a20-9d3f-ea0edc292cf8)

Значения целевых метрик:
1. CER: 0.7150;
2.  Accuracy: 0.1300.

### 2. CRNN

Падение функции потерь при использовании данной архитектуры приведено на графике

![loss_CRNN](https://github.com/user-attachments/assets/c6410f05-ad84-4c09-99a6-f8dc2e4c7802)

Значения целевых метрик:
1. CER: 0.7703;
2.  Accuracy: 0.001.

### 3. CNNBox

Падение функции потерь при использовании данной архитектуры приведено на графике

![loss_Box](https://github.com/user-attachments/assets/6f54896a-ab9a-4306-9f58-207894728be7)

Значения целевых метрик:
1. CER: 0.2531;
2.  Accuracy: 0.4416.

Созданные архитектуры нейронных сетей обладают низкой точностью, поэтому было принято использовать предобученную модель EasyOCR.

### 4. EasyOCR

Значения целевых метрик:
1. CER: 0.1127;
2.  Accuracy: 0.8090.

## Вывод

### Выбор модели

Наибольшей точностью и быстродействием обладает предобученная модель EasyOCR. Ее использование является наиболее перспективным.

### Рекомендации к улучшению

Для всех описанных архитектур нейронных сетей можно попробовать:

1. Увеличить число использованных слои сверточных, полносвязных и рекуррентных слоев, изменять функции активации;
2. Использовать другой декодировщик последовательности (для этой цели можно использовать обученную языковую модель);
3. Именять скорость обучения, количество эпох обучения.

Далее планируется попробовать данные методы улучшения.

Также возможно использовать другие предобученные модели OCR (например YOLO, Tesseract).

Помимо этого необходимо пробовать другие архитектуры нейронных сетей.

## Заключение

Цель, поставленная в работе выполнена.

Все поставленные задачи выполнены:

1. Проанализирован датасет, определены символы, находящиеся на изображениях, определены предполагаемые методы предобработки данных;
2. Спроектировано 3 архитектуры нейронных сетей. Также описан модуль для использования предобученной модели OCR;
3. Проанилизированы поулченные результаты. Даны рекомендации к улучшению. Выбрана модель EasyOCR как ниболее точная и быстрая;
4. Оформлено решение проекта: выполнено разбиение на модули, написаны комментарии к коду, результаты работы приведены в архиве ***result.zip***.


